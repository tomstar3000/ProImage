(function(n,t){var i=(n.Aurigma||(n.Aurigma={__namespace:!0}))&&(n.Aurigma.ImageUploader||(n.Aurigma.ImageUploader={__namespace:!0}));i.nirvanixExtender=function(n){if(!(this instanceof i.nirvanixExtender))return new i.nirvanixExtender(n);n.state()==1&&i.debug().showError("NirvanixExtender should be created before uploader initialization."),n.uploadSettings().actionUrl("http://localhost"),this._uploader=n,this._serviceError=new i.event;var t=this;n.events().beforeUpload().add(function(){return t._onBeforeUpload.apply(t,arguments)}),n.events().beforePackageUpload().add(function(){return t._onBeforePackageUpload.apply(t,arguments)}),n.events().afterPackageUpload().add(function(){return t._onAfterPackageUpload.apply(t,arguments)}),this._errors={"100":"MissingRequiredParameter","101":"InvalidParameter","160":"UnsupportedOperation","50103":"ParameterOutOfAcceptedRange","55001":"InvalidPayment","55100":"CreditCardChargeFailed","65001":"CreateAccountFailed","65002":"CreateAccountContactFailed","65003":"InvalidSlaError","65004":"InvalidAppKey","65005":"InvalidAccountType","65006":"DuplicateUserNameUnderAppKey","65007":"DuplicateAppName","65008":"PageSizeExceedsLimit","65009":"DeletedAccount","65010":"InvalidStatus","65011":"InvalidSecurityResponse","65012":"InvalidUserNameOrPassword","65016":"DuplicateMasterAccountUserName","65101":"InvalidContactParameter","65102":"AppNameNotFound","65104":"UserNameNotFound","70001":"FolderNotFound","70002":"FileNotFound","70003":"PathNotFound","70004":"AlreadyExists","70005":"InvalidPath","70006":"DownloadPathNotFound","70007":"MetadataDoesNotExist","70008":"FolderAlreadyExists","70009":"PathTooLong","70010":"FileFolderNameTooLong","70101":"NullOrEmptyPath","70102":"InvalidPathCharacter","70103":"InvalidAbsolutePath","70104":"InvalidRelativePath","70106":"FileIntegrityError","70107":"InvalidMetadata","70108":"RangeNotSatisfiable","70109":"PathTooShort","70110":"FileOffline","70111":"InvalidImageDimensions","80001":"LoginFailed","80003":"AccessDenied","80004":"InvalidMasterAccountID","80005":"InvalidBillableAccountID","80006":"SessionNotFound","80007":"AccountExpired","80015":"OutOfBytes","80016":"OutOfBytesNonOwner","80018":"InvalidIPAddress","80019":"DownloadFileSizeLimitExceeded","80020":"UploadBandwidthLimitExceeded","80021":"StorageLimitExceeded","80022":"LimitAlreadyExceeded","80023":"InvalidAccessToken","80101":"InvalidSessionToken","80102":"ExpiredAccessToken","80103":"InvalidDownloadToken","90001":"Configuration","90002":"SSLRequired","100001":"Database"}},i.nirvanixExtender.prototype={__class:!0,_onBeforeUpload:function(){if(!this.uploadToken()||!this.uploadHost()||!this.destFolderPath())return i.debug().showError("You should specify UploadToken, UploadHost, and DestFolderPath for using NirvanixExtender"),!1;this._uploader.uploadSettings().actionUrl(n.location.protocol+"//"+this.uploadHost()+"/Upload.ashx")},_onBeforePackageUpload:function(){var t=this._uploader,n=t.metadata();n.addCustomField("uploadToken",this.uploadToken()),n.addCustomField("destFolderPath",this.destFolderPath())},_onAfterPackageUpload:function(n,r){var a=r+"",l=/<ResponseCode>\s*(\d+)\s*<\/ResponseCode>/ig,e,h,s,f,c,o,u;if(l.test(a)){e=parseInt(RegExp.$1,10);if(e!=0){if(this._serviceError.count()>0){for(h=this._serviceError,s=!0,f=0,c=h.length;f<c;f++)o=h[f](),s&=o==t||!!o;return s}return u=this._errors[e],u==t&&(u="Unknown"),i.debug().showError("Error occured (#"+e+", "+u+") during an upload to Nirvanix service."),!0}}else return i.debug().showError("Unexpected response from Nirvanix service."),!0},_prop:function(n,t,i){if(i)this["_"+n]=t;else return this["_"+n]},uploadToken:function(){return this._prop("uploadToken",arguments[0],arguments.length)},uploadHost:function(){return this._prop("uploadHost",arguments[0],arguments.length)},destFolderPath:function(){return this._prop("destFolderPath",arguments[0],arguments.length)},serviceError:function(){if(arguments.length==0)return this._serviceError;this._serviceError.add(arguments[0])}}})(window)